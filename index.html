<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Soccer player analysis</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <link rel="stylesheet" href="stylesheets/d3_styles.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="favicons/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="favicons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="favicons/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="favicons/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="favicons/manifest.json">
    <link rel="mask-icon" href="favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#b38e8e">

    <!Reference to image slider>
    <link href="javascripts/slider/js-image-slider.css" rel="stylesheet" type="text/css" />
    <script src="javascripts/slider/js-image-slider.js" type="text/javascript"></script>
    
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <!Code for the D3 visualization>
    <script type="text/javascript"></script>
    <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
    <script src="javascripts/d3_js.js"></script>
    <style type="text/css">
            circle:hover {
                fill: orange;
            }
            .btn {
                background: #3498db;
                background-image: -webkit-linear-gradient(top, #3498db, #2980b9);
                background-image: -moz-linear-gradient(top, #3498db, #2980b9);
                background-image: -ms-linear-gradient(top, #3498db, #2980b9);
                background-image: -o-linear-gradient(top, #3498db, #2980b9);
                background-image: linear-gradient(to bottom, #3498db, #2980b9);
                -webkit-border-radius: 4;
                -moz-border-radius: 4;
                border-radius: 4px;
                font-family: Arial;
                color: #ffffff;
                font-size: 13px;
                padding: 4px 4px 4px 4px;
                text-decoration: none;
            }
            .btn:hover {
                background: #3cb0fd;
                background-image: -webkit-linear-gradient(top, #3cb0fd, #3498db);
                background-image: -moz-linear-gradient(top, #3cb0fd, #3498db);
                background-image: -ms-linear-gradient(top, #3cb0fd, #3498db);
                background-image: -o-linear-gradient(top, #3cb0fd, #3498db);
                background-image: linear-gradient(to bottom, #3cb0fd, #3498db);
                text-decoration: none;
            }
            .header-cont {
                width:100%;
                position:fixed;
                top:0px;
                height:130px;
                background-image:url('logos/pattern_bg.jpeg')
            }
            .wrapper{
                margin-top:90px;
            }
            .content {
                margin-left: auto;
                margin-right: auto;
                table-layout: fixed;
                border-collapse: collapse;
                z-index: -1; position:relative
            }
    </style>
  </head>
  <body>
    <div class="header-cont">
      <img src = "logos/Arsenal_FC.png" width = 10% height = 100 style="border-style: none">
      <img src = "logos/PSG.png" width = 10% height = 100 style="border-style: none">
      <img src = "logos/BayernMunich.png" width = 10% height = 100 style="border-style: none">
      <img src = "logos/Real_Madrid.png" width = 10% height = 100 style="border-style: none">
      <img src = "logos/FC_Barcelona.png" width = 10% height = 100 style="border-style: none">
      <img src = "logos/Juventus.png" width = 8% height = 100 style="border-style: none">
      <img src = "logos/BorussiaDortmund.png" width = 10% height = 100 style="border-style: none">
      <img src = "logos/Inter_Milan.png" width = 10% height = 100 style="border-style: none">
      <img src = "logos/Chelsea_FC.png" width = 10% height = 100 style="border-style: none">
    </div>
  
    <div class="wrapper">
      <header>
        <h1 class="header">cs109-FIFA</h1>
        <p class="header">Repository for CS109 Final Project</p>

        <ul>
          <li><a class="sbuttons" href="https://github.com/cs109-FIFA/cs109-FIFA/blob/master/Process%20Workbook.ipynb">Process Notebook</a></li>
          <li class="download"><a class="buttons" href="https://github.com/twkillian/cs109-FIFA/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/twkillian/cs109-FIFA">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/twkillian">Taylor Killian</a>, <a class="header name" href="https://github.com/abhishekmalali">Abhishek Malali</a> and <a class="header name" href="https://github.com/virgodi">Virgile Audi</a></p>


      </header> 
        
      <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluation of football player performance</h1>
         
          <p>The primary motive of the project outlined below was designed to answer the following question: Can we evaulate and infer a player's value to his team based solely on the impact that they have on matches? In this respect, and to simplify our analysis, we define "impact" to mean the goals and assists provided for their team during various game states.</p>

      </section>
      <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Project Overview</h1>

        <iframe width="560" height="315" src="https://www.youtube.com/embed/m2rhRJkWOEI" frameborder="0" allowfullscreen></iframe>

        <h3>Background and Motivation</h3>


        <p>When football clubs do not perform equal to their, and their fans', expectations they look to infuse their team with more talented players, typically drawn from lower-tier or financially poor teams. The financial incentive for both teams in any transaction is clear, the buying team has hope that the new addition will put them over the top talent-wise to improve their standing in league competition while the selling team may look at the new funds as a way to prepare for the future and secure several new players to improve their team long-term.</p>
        
        <p>Within the last 5 years, the economy of player transfers has undergone significant inflation where the top-tier clubs have shown a willingness to overpay for marginal talent or for players that may not be a good fit in their team. There is some notion that the transfer system is broken and is in need of revitalization. There are multiple ways to address the psychology of club executives and try to identify their motivations for spending money to procure new talent for their team. We refrain from any investigation into club finances but want to determine a method by which we can accurately and objectively place value on any player based on the impact that they have on the matches they play in.</p>
        
        <h3>Project Objectives</h3>
        <p>Our primary motivation is to quantify the impact (based on goals scored, assists made and consistency of play) an individual player has on the games which he plays for his team. We intend to use this quantity for each player to infer their value (agnostic of team at first and later based on current team and potential buyers). We hope to learn more about what goes into modeling player value, beyond subjective measures of team they currently play for and the league they currently play in, and how we can compare like players with each other.</p>

      <!Section 1 - How transfer market has behaved>
      <!Insert all images inside div with class content>
      <section>
        <h1>
        <a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Player transfer market over the years</h1>

        <p>The player transfer market has seen ever increasing transfer amounts over the years. Ever increasing broadcasting deals have made the leagues richer which has reflected in the spending.</p>

        <p>We looked at the top 100 transfers in the last 20 years. The last five years alone account for 65 transfers in the top 100 list with the transfer record being shattered twice. This trend motivated us to investigate if the market was inflated and whether or not the players justified their value for the respective transfer amount.</p>
        <div class="content">
        <div id="sliderFrame" >
              <div id="slider">
                  <img src='images/amount.png'  align='middle' style="border-style: none">
                  <img src='images/number.png'  align='middle' style="border-style: none">
              </div>
        </div>
        </div>


      </section>
      <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data scraping</h1>
        <p> The data we use for our analysis is scraped is from <a href="http://www.worldfootball.net">World Football</a>. World Football has match by match data in terms of the players who participated in the games as well as the goal scorers. The site had data for all the five leagues which we were interested in. The url links were not hard to deal with provided we had a list of teams which participated in a league for that year. We scraped the goalscorers, players who assisted the goalscorer along with the time at which the goal was scorer. We also recorded the time at which the goal was scored and whether the goal scorer and assist maker were substituted. We scraped the data for the seasons of 2012-13 and 2013-14 and faced minor hiccups with the Italian team of Atalanta for which we had manually enter the data.</p>
        <p>Overall we scrape 760 pages for every league which in total was about 3800 webpages.</p>

        <p>The transfer values were scraped from the Wikipedia link for transfers for every league for a season. The French and the German league did not have transfer values mentioned for the season's under consideration. The Spanish league did not have transfer data available for the summer of 2014. An example of the data which we had to scrape can be looked here at <a href="https://en.wikipedia.org/wiki/List_of_English_football_transfers_summer_2013">Wikipedia</a>.</p>
    </section>
      <!Inserting the D3 Visualization>
      <section>
          <h1><a id="transfer-plot" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Plot comparing transfers across leagues</h1>
        <p>We wanted to visualize where the big money transfers were happening. The plot below was built in D3 for specifically that purpose. It was see the emphasis of the price of the player on different emtrics like goals, assists and the metric score generated by us. This could also help find groupings of players who were available in the similar price range while providing the same attacking punch in terms of goals.</p>
        <div id="wrapper">
        <div id="england">
        <input name="engButton" 
           type="button"
           class='btn'
           value="English League" 
           onclick="viewEngland()" />
        </div>
        <div id="spain">
        <input name="engButton" 
           type="button"
           class='btn'
           value="Spanish League" 
           onclick="viewSpain()" />
        </div>
        <div id="italy">
        <input name="engButton" 
           type="button"
           class='btn'
           value="Italian League" 
           onclick="viewItaly()" />
        </div>
        <div id="sval">
        <input name="engButton" 
           type="button"
           class='btn'
           value="By Season Value" 
           onclick="viewSeasonValue()" />
        </div>
        <div id="goals">
        <input name="engButton" 
           type="button" 
           class='btn'
           value="By Goals" 
           onclick="viewGoals()" />
        </div>
        <div id="assists">
        <input name="engButton" 
           type="button"
           class='btn'
           value="By Assists" 
           onclick="viewAssists()" />
        </div>
    </div>
    <div id="chartline1" ></div> 
      </section>
    
    <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Metric used for player Valuation</h1>

        <p>Relevant details about the metric.</p>
    </section>
    <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Top players over the period</h1>

        <p>Using traditional statistics, we look at the best players in terms of goals and assists. The first plot show the best players for the season of 2012-13. The top players were names you would have heard of even if you aren't as ardent a soccer fan as our team.</p>
        <div class="content">
        <img src='images/2012-13-top20-traditional.jpg' height=330 align='middle' style="border-style: none">
        </div>
        <p>We evaluate the top players for the season of 2012-13 using the metric which we have defined.</p>
        <div class="content">
        <img src='images/2012-13-top20-metric.jpg' height=330 align='middle' style="border-style: none">
        </div>
        <p>Our list of top 20 players is very similar to the list we generated using traditional statistics. But in effect there are a few names we might come across as anomalies like Stephan Kiessling. This just goes to show that our metric gives credit to players who are valuable in contributions but are forgotten when we look at their absolute statistics. Comparing our proposed metric with the traditional statistics.</p>
        <div class="content">
        <img src='images/rankingDiff2.jpg' height=400 align='middle' style="border-style: none">
        </div> 
        <p>In the plot above we chart the ranking according to our metric compared to the ranking if we went along traditionally. The 45 degree line is plotted for reference. We see that certain players who were ranked highly as per the goals + assist metric did fall down the ranking ladder when the metric changed. The metric does not affect the top players since we see a close grouping near the origin. But as we go down the ranking ladder we see significant jumps. We find lots of players who weren't ranked well now within the top 50. This directly states that we are doing a decent job of finding underrated players who contribute immensely but are not noticed.</p>

        <p>For the two most recognisable players, Lionel Messi and Cristiano Ronaldo we see how their scores evolve over the season in the plot below. A consistent performance in most games is the desirable trend we want to see with the succesfull forwards.</p>
        <div class="content">
        <img src='images/messi-vs-ronaldo-12-13.jpg' height=350 align='middle' style="border-style: none">
        </div>
        <p>As you can see from the time series above Messi dominated Cristiano Ronaldo in almost every game for the 2012-13 season. The contribution was rewarded with the FIFA World Player of the Year award for Messi for 2012 season.</p>

        <p>We were keen on analyzing these time series for some interesting players for a season. But complexity of analyzing every set of players visually and making key discoveries was cumbersome.</p>

        <p>To check consistency of our metric against what really transpired in the season, we add up all the scores for the players in a team and rank them. We then compare this ranking to the actual ranking of the team achieved in the season. As the plot shows below, the rankings predicted by our measure were close to actual results and showed a correlation of 0.73. This is due to us giving consideration to the attacking statistics and lack of freely available defensive statistics data.</p>
        <div class="content">
        <img src='images/correlation-plot-bpl-12-13.png' height=500 align='middle' style="border-style: none">
        </div>
        <p>For the spanish league for the season 2012-13 we did find or rankings to be much closer to the final rankings. In this case the correlation was 0.92.</p>
        <div class="content">
        <img src='images/correlation-plot-spl-12-13.png' height=500 align='middle' style="border-style: none">
        </div>
      </section>
      <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Clustering the players on the basis of metrics</h1>
        <p>As football enthusiasts a key question which we wanted to address to find the players which are very similar. This would be meaningless if it was done just using the data like goals and assists, since those numbers can mislead us on the contribution. Hence we used the entirety of the data including the unwrapped contribution time series. This would cluster players who contribute similarly in the games as well over the seasons.</p>

        <p>We found clusters of similar minded players for both seasons. An interesting way of looking at performance would be find players who move between clusters over seasons. This can indicate an improvement or decrement in performance over seasons.</p>
        <iframe width="600" height="500" frameborder="0" scrolling="no" src="https://plot.ly/~AbhishekMalali/20.embed" class="iframe-class"></iframe>
        <iframe width="600" height="500" frameborder="0" scrolling="no" src="https://plot.ly/~AbhishekMalali/24.embed" class="iframe-class"></iframe>

        <p> An interesting note to make here would be that Messi was classified with Robin van persie who had way lesser goals and assists. He was equally monumental in helping his team to the Premier league title. These were the kind of clusters and observations we were hoping we would get to see when we processed and clustered our data.</p>
         
    </section>
    <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Validating our metric</h1>

        <p>We train a few classifiers to identify whether or not we can predict calculated value from one season to the next. Initially, we will train a random forest classifier on a 70/30 train/test split from the 2012-2013 season.</p>
        <p>Using the data, we run a Random forest regressor to figure out the most domninating features in the data.</p>
        <div class="content">
        <img src='images/feature-importance.jpg' height=450 align='middle' style="border-style: none">
        </div>
        <p>Here we see that the importance of the 'avg_value' and 'avg_value_smoothed' features far outweigh the others. After seeing this, we'll remove the two of them and only use the incremented totals for goals and assists.</p>
        <div class="content">
        <img src='images/feature-importance-corrected.jpg' height=450 align='middle' style="border-style: none">
        </div>
        <p>After training and predicting, we see a tight grouping around the 45 degree line.</p>
        <div class="content">
        <img src='images/actual-vs-predicted-2012-13.jpg' height=450 align='middle' style="border-style: none">
        </div>
        <p>After training and predicting on the 2013-14 dataset.</p>
        <div class="content">
        <img src='images/actual-vs-predicted-2013-14.jpg' height=450 align='middle' style="border-style: none">
        </div>
        <p>We use a linear regressor to predict and we find a very high accuracy for both the seasons.</p>
        <div class="content">
        <img src='images/rf-actual-vs-predicted-2012-13.jpg' height=450 align='middle' style="border-style: none">
        </div>
        <p>Add extra comments.</p>
         <div class="content">
        <img src='images/rf-actual-vs-predicted-2013-14.jpg' height=450 align='middle' style="border-style: none">
        </div>
    </section>

    <section>
        <h1><a id="cs109-FIFA" class="anchor" href="#cs109-fifa" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion</h1>

        <p>Fill in relevant details</p>
    </section>

    
      <footer> 
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
  </body> 
</html>
<!doctype html>

